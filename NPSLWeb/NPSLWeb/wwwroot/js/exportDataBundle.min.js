function exportClickCSV(){var t=[],r=[],i;$("#reconsileDatatable th").each(function(){t.push($(this).text())});$("#reconsileDatatable td").each(function(){r.push($(this).text())});i=prepCSVRow(t,t.length,"");i=prepCSVRow(r,t.length,i);var n=document.createElement("a"),u=new Blob(["ï»¿",i]),f=URL.createObjectURL(u);n.href=f;n.download="ReconsileReport.csv";document.body.appendChild(n);n.click();document.body.removeChild(n)}function exportClickXLS(){$("#reconsileDatatable").table2excel()}function base64_encode(n){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e,o,s,h,c,l,a,t,r=0,y=0,f="",v=[],u;if(!n)return n;do e=n.charCodeAt(r++),o=n.charCodeAt(r++),s=n.charCodeAt(r++),t=e<<16|o<<8|s,h=t>>18&63,c=t>>12&63,l=t>>6&63,a=t&63,v[y++]=i.charAt(h)+i.charAt(c)+i.charAt(l)+i.charAt(a);while(r<n.length);return f=v.join(""),u=n.length%3,(u?f.slice(0,u-3):f)+"===".slice(u||3)}function prepCSVRow(n,t,i){function e(n,t){var i=[],r=[];return n.forEach(function(n,u){(u+1)%t==0?(i.push(n),r.push(i),i=[]):i.push(n)}),r}var r="",u=",",f="\r\n",o=e(n,t);return o.forEach(function(n){n.forEach(function(t,i){r+=t+(i+1===n.length?"":u)});r+=f}),i+r}(function(n,t,i){function e(t,i){this.element=t;this.settings=n.extend({},f,i);this._defaults=f;this._name=r;this.init()}function u(n){return(n.filename?n.filename:"ReconsileReport")+(n.fileext?n.fileext:".xls")}var r="table2excel",f={exclude:".noExl",name:"Table2Excel"};e.prototype={init:function(){var t=this;t.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>',sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"<\/x:Name><x:WorksheetOptions><x:DisplayGridlines/><\/x:WorksheetOptions><\/x:ExcelWorksheet>"},mid:"<\/x:ExcelWorksheets><\/x:ExcelWorkbook><\/xml><![endif]--><\/head><body>",table:{head:"<table>",tail:"<\/table>"},foot:"<\/body><\/html>"};t.tableRows=[];n(t.element).each(function(i,r){var u="";n(r).find("tr").not(t.settings.exclude).each(function(t,i){u+="<tr>"+n(i).html()+"<\/tr>"});t.tableRows.push(u)});t.tableToExcel(t.tableRows,t.settings.name,t.settings.sheetName)},tableToExcel:function(r,f,e){var o=this,s="",h,l,c,a;if(o.uri="data:application/vnd.ms-excel;base64,",o.base64=function(n){return t.btoa(unescape(encodeURIComponent(n)))},o.format=function(n,t){return n.replace(/{(\w+)}/g,function(n,i){return t[i]})},e=typeof e=="undefined"?"Sheet":e,o.ctx={worksheet:f||"Worksheet",table:r,sheetName:e},s=o.template.head,n.isArray(r))for(h in r)s+=o.template.sheet.head+e+h+o.template.sheet.tail;if(s+=o.template.mid,n.isArray(r))for(h in r)s+=o.template.table.head+"{table"+h+"}"+o.template.table.tail;s+=o.template.foot;for(h in r)o.ctx["table"+h]=r[h];return delete o.ctx.table,typeof msie!="undefined"&&msie>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)?typeof Blob!="undefined"?(s=[s],a=new Blob(s,{type:"text/html"}),t.navigator.msSaveBlob(a,u(o.settings))):(txtArea1.document.open("text/html","replace"),txtArea1.document.write(o.format(s,o.ctx)),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,u(o.settings))):(l=o.uri+o.base64(o.format(s,o.ctx)),c=i.createElement("a"),c.download=u(o.settings),c.href=l,i.body.appendChild(c),c.click(),i.body.removeChild(c)),!0}};n.fn[r]=function(t){var i=this;return i.each(function(){n.data(i,"plugin_"+r)||n.data(i,"plugin_"+r,new e(this,t))}),i}})(jQuery,window,document);